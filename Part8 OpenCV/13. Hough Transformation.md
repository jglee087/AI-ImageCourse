# Hough Transformation



í—ˆí”„ë³€í™˜ì€ ì´ë¯¸ì§€ì—ì„œ ëª¨ì–‘ì„ ì°¾ëŠ” ê°€ì¥ ìœ ëª…í•œ ë°©ë²•ì´ë‹¤. ì´ ë°©ë²•ì„ ì´ìš©í•˜ë©´ ì´ë¯¸ì§€ì˜ í˜•íƒœë¥¼ ì°¾ê±°ë‚˜, ëˆ„ë½ë˜ê±°ë‚˜ ê¹¨ì§„ ì˜ì—­ì„ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ í—ˆí”„ë³€í™˜ì˜ ì§ì„ ì˜ ë°©ì •ì‹ì„ ì´ìš©í•©ë‹ˆë‹¤. í•˜ë‚˜ì˜ ì ì„ ì§€ë‚˜ëŠ” ë¬´ìˆ˜í•œ ì§ì„ ì˜ ë°©ì ì‹ì€ y=ax+bë¡œ í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë©°, ì´ê²ƒì„ ì‚¼ê°í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë³€í˜•í•˜ë©´ r = ğ‘¥ cos ğœƒ + ğ‘¦ sin ğœƒ ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¼ ì•„ë˜ ì´ë¯¸ì§€ë¥¼ ë³´ì.

![](./img/img32.png)

3ê°œì˜ ì ì´ ìˆê³ , ê·¸ì¤‘ ìš°ë¦¬ê°€ ì°¾ëŠ” ì§ì„ ì€ í•‘í¬ìƒ‰ ì§ì„ ì´ë‹¤. ê·¸ëŸ¼ ê° ì  (x,y)ì— ëŒ€í•´ì„œ ì‚¼ê°í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ğœƒ ê°’ì„ 1 ~ 180ê¹Œì§€ ë³€í™”ë¥¼ í•˜ë©´ì„œ ì›ì ì—ì„œ (x,y)ê¹Œì§€ì˜ ê±°ë¦¬(r)ì„ êµ¬í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ (ğœƒ, r)ë¡œ êµ¬ì„±ëœ 180ê°œì˜ 2ì°¨ì› ë°°ì—´ì„ êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ í•´ì„œ êµ¬í•´ì„œ 2ì°¨ì› ë°°ì—´ì„ ë‹¤ì‹œ ê·¸ë˜í”„ë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì‚¬ì¸íŒŒ ê·¸ë˜í”„ë¡œ í‘œí˜„ì´ ëœë‹¤. ì•„ë˜ 3ê°œì˜ ë°©ì •ì‹ì˜ ë§Œë‚˜ëŠ” ì ì´ ë°”ë¡œ ì§ì„ ì¸ í™•ë¥ ì´ ë†’ì€ ì ì´ë‹¤. ì¦‰, ğœƒê°€ 60ì´ê³  ê±°ë¦¬ê°€ 80ì¸ ì§ì„ ì˜ ë°©ì •ì‹ì„ êµ¬í•  ìˆ˜ ìˆëŠ” ê²ƒ ì…ë‹ˆë‹¤.

![](./img/img33.png)

1. HoughLines, HoughCircles

   ```
   lines = cv2HoughLineP(img, rho, theta, threshold[, lines, minLineLength, maxLineGap]) : ê²€ì¶œí•œ ì„ ì˜ ê²°ê³¼ ê°’ì´ ì„ ì˜ ì‹œì‘ê³¼ ë ì¢Œí‘œì´ë‹¤.
   img : ì…ë ¥ì˜ìƒ, ì´ë¯¸ì§€
   rho : ê±°ë¦¬ì¸¡ì • í•´ìƒë„, 0~1
   theta : ê°ë„ ì¸¡ì • í•´ìƒë„, ë¼ë””ì•ˆ ë‹¨ìœ„( np.pi/0~180)
   threshold : ì§ì„ ìœ¼ë¡œ íŒë‹¨í•  ìµœì†Œí•œì˜ ë™ì¼ ê°œìˆ˜
   ì‘ì€ ê°’ : ì •í™•ë„ ê°ì†Œ, ê²€ì¶œ ê°œìˆ˜ ì¦ê°€
   í° ê°’ : ì •í™•ë„ ì¦ê°€, ê²€ì¶œ ê°œìˆ˜ ê°ì†Œ
   lines : ê±°ë¬¼ëœ ì„  ì¢Œí‘œ, N X 1 X 4 ë°°ì—´ ( x1, y1, x2, y2 )
   minLineLength : ì„ ìœ¼ë¡œ ì¸ì •í•  ìµœì†Œ ê¸¸ì´
   maxLineGap : ì„ ìœ¼ë¡œ íŒë‹¨í•œ ìµœëŒ€ ê°„ê²©
   min_theta, max_theta : ê²€ì¶œì„ ìœ„í•´ ì‚¬ìš©í•  ìµœëŒ€, ìµœì†Œ ê°ë„
   ```

   ```
   circles = cv2.Houghcircles(img, method, dp, minDist[, circles, param1, param2, minRadius, maxRadius])
   img : ì…ë ¥ ì˜ìƒ, ì´ë¯¸ì§€
   method : ê²€ì¶œ ë°©ì‹ ì„ íƒ,
   cv2.HOUGH_GRADIENT ë§Œ ê°€ëŠ¥
   dp : ì…ë ¥ ì˜ìƒ, ì´ë¯¸ì§€ì™€ ê²½ì‚¬ ëˆ„ì ì˜ í•´ìƒë„ ë°˜ë¹„ë¡€ìœ¨, 1: ì…ë ¥ê³¼ ë™ì¼, ê°’ì´ ì»¤ì§ˆìˆ˜ë¡ ë¶€ì •í™•
   minDist : ì›ë“¤ ì¤‘ì‹¬ê°„ì˜ ìµœì†Œ ê±°ë¦¬, 0: ì—ëŸ¬ (ë™ì‹¬ì› ê²€ì¶œ ë¶ˆê°€)
   circles : ê²€ì¶œ ì› ê²°ê³¼, N X 1 X 3 ë¶€ë™ ì†Œìˆ˜ì  ë°°ì—´ (x, y, ë°˜ì§€ë¦„)
   param1 : ìºë‹ˆ ì—£ì§€ì— ì „ë‹¬í•  ìŠ¤ë ˆì‹œí™€ë“œ ìµœëŒ€ ê°’(ìµœì†Œ ê°’ì€ ìµœëŒ€ ê°’ì˜ 2ë°° ì‘ì€ ê°’ì„ ì „ë‹¬)
   param2 : ê²½ì‚¬ë„ ëˆ„ì  ê²½ê³„ ê°’(ê°’ì´ ì‘ì„ìˆ˜ë¡ ì˜ëª»ëœ ì› ê²€ì¶œ)
   minRadius, maxRadius : ì›ì˜ ìµœì†Œ ë°˜ì§€ë¦„, ìµœëŒ€ ë°˜ì§€ë¦„ (0ì´ë©´ ì˜ìƒì˜ í¬ê¸°)
   ```

   ```
   import cv2 
   import numpy as np 
   import matplotlib.pyplot as plt 
   
   #ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
   img = np.zeros((500,500), np.uint8)
   cv2.circle(img, (200, 200), 50, 255, 3)
   cv2.line(img, (100, 400), (400, 350), 255, 3)
   
   #ì„ , ì›ê²€ì¶œ
   lines=cv2.HoughLinesP(img, 1, np.pi/180, 100, 100 ,10)[0]
   circles=cv2.HoughCircles(img, cv2.HOUGH_GRADIENT, 1, 15, param1=200, param2=30)[0]
   
   dbg_img=np.zeros( (img.shape[0], img.shape[1], 3), np.uint8)
   
   for x1, y1, x2, y2 in lines:
       print('Detected line: ({} {}), ({} {})'.format(x1,y1,x2,y2))
       cv2.line(dbg_img, (x1,y1),(x2,y2),(0,255,0),2)
   
   for c in circles:
       print('Detected circle: center= ({},{}), radius={}'.format(c[0],c[1], c[2]))
       cv2.circle(dbg_img, (c[0],c[1]), c[2], (0,0,255), 2)
       
       #ê²€ì¶œëœ ì§ì„ ê³¼ ì›ì„ ê·¸ë¦°ë‹¤.
   
   #ì‹œê°í™”í•œë‹¤. 
   plt.figure(figsize=(8,10))
   plt.subplot(121)
   plt.title('original')
   plt.axis('off')
   plt.imshow(img, cmap='gray')
   plt.subplot(122)
   plt.title('detected primitives')
   plt.axis('off')
   plt.imshow(dbg_img)
   plt.show()
   ```

   

2. ìŠ¤ë„ì¿  ì´ë¯¸ì§€ ì„  ê²€ì¶œ

   ```python
   img = cv2.imread('img/sudoku.jpg')
   img2 = img.copy()
   
   # ê·¸ë ˆì´ ìŠ¤ì¼€ì¼ë¡œ ë³€í™˜ ë° ì—£ì§€ ê²€ì¶œ ---â‘ 
   imgray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
   edges= cv2.Canny(imgray, 50, 200)
   
   # í™•ìœ¨ í—ˆí”„ ë³€í™˜ ì ìš© ---â‘¡
   lines=cv2.HoughLinesP(edges, 1, (np.pi/180), 10, None, 20, 2)
   
   for line in lines:
   
       # ê²€ì¶œëœ ì„  ê·¸ë¦¬ê¸° ---â‘¢
       x1,y1,x2,y2 =line[0]
       #print('Detected line: ({} {}), ({} {})'.format(x1,y1,x2,y2))
       cv2.line(img2, (x1,y1),(x2,y2),(0,255,0),1)
       
   
   merged = np.hstack((img, img2))
   cv2.imshow('Probability hough line', merged)
   cv2.waitKey()
   cv2.destroyAllWindows()
   ```

   

3. ì²´ìŠ¤íŒ ê·¸ë¦¬ë“œ íŒ¨í„´ ê²€ì¶œ

   ```
   image_chess = cv2.imread('data/chessboard.png')
   
   found, corners= cv2.findChessboardCorners(image_chess, (6,9))
   assert found == True, "can't find chess board pattern"
   
   dbg_image_chess = image_chess.copy()
   cv2.drawChessboardCorners(dbg_image_chess,(6,9),corners, found)
   plt.figure(figsize=(8,4))
   plt.subplot(121)
   plt.title('original')
   plt.axis('off')
   plt.imshow(image_chess)
   plt.subplot(122)
   plt.title('detected pattern')
   plt.axis('off')
   plt.imshow(dbg_image_chess)
   plt.show()
   
   ```



4. ì²´ìŠ¤íŒ ì› ê·¸ë¦¬ë“œ íŒ¨í„´ ê²€ì¶œ

   ```
   image_circles = cv2.imread('data/circlesgrid.png')
   
   found, corners = cv2.findCirclesGrid(image_circles,(6,6),flags=cv2.CALIB_CB_SYMMETRIC_GRID)
   
   assert found == True, "can't find chess board pattern"
   
   dbg_image_circles = image_circles.copy()
   cv2.drawChessboardCorners(dbg_image_circles,(6,6),corners, found)
   
   plt.figure(figsize=(8,8))
   plt.subplot(221)
   plt.title('original')
   plt.axis('off')
   plt.imshow(image_chess)
   plt.subplot(222)
   plt.title('detected pattern')
   plt.axis('off')
   plt.imshow(dbg_image_chess)
   plt.show()
   plt.subplot(223)
   plt.title('original')
   plt.axis('off')
   plt.imshow(image_circles)
   plt.subplot(224)
   plt.title('detected pattern')
   plt.axis('off')
   plt.imshow(dbg_image_circles)
   plt.tight_layout()
   plt.show()
   ```

   



